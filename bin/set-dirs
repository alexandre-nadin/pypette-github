#!/usr/bin/env bash
set -euf -o pipefail
mkdir -p "$WORKFLOW_DIR"
cd "$WORKFLOW_DIR"

function mountClusterPoint() {
  mkdir -p "$CLUSTER_MNT_POINT"
  mountpoint -q "$CLUSTER_MNT_POINT" \
   || sshfs -o nonempty anadin@172.21.151.42:${1:-/} "$CLUSTER_MNT_POINT"
}

# Mount cluster directory if specified
if [ ! -z "${CLUSTER_MNT_POINT:+x}" ]; then
  mountClusterPoint "/"
fi
